!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).PowerAudio=t()}}(function(){return function o(a,s,c){function h(e,t){if(!s[e]){if(!a[e]){var i="function"==typeof require&&require;if(!t&&i)return i(e,!0);if(u)return u(e,!0);var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}var r=s[e]={exports:{}};a[e][0].call(r.exports,function(t){return h(a[e][1][t]||t)},r,r.exports,o,a,s,c)}return s[e].exports}for(var u="function"==typeof require&&require,t=0;t<c.length;t++)h(c[t]);return h}({1:[function(t,e,i){"use strict";var n=this&&this.__awaiter||function(o,a,s,c){return new(s||(s=Promise))(function(t,e){function i(t){try{r(c.next(t))}catch(t){e(t)}}function n(t){try{r(c.throw(t))}catch(t){e(t)}}function r(e){e.done?t(e.value):new s(function(t){t(e.value)}).then(i,n)}r((c=c.apply(o,a||[])).next())})},r=this&&this.__generator||function(i,n){var r,o,a,t,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,o&&(a=2&e[0]?o.return:e[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,e[1])).done)return a;switch(o=0,a&&(e=[2&e[0],a.value]),e[0]){case 0:case 1:a=e;break;case 4:return s.label++,{value:e[1],done:!1};case 5:s.label++,o=e[1],e=[0];continue;case 7:e=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===e[0]||2===e[0])){s=0;continue}if(3===e[0]&&(!a||e[1]>a[0]&&e[1]<a[3])){s.label=e[1];break}if(6===e[0]&&s.label<a[1]){s.label=a[1],a=e;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(e);break}a[2]&&s.ops.pop(),s.trys.pop();continue}e=n.call(i,s)}catch(t){e=[6,t],o=0}finally{r=a=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}};Object.defineProperty(i,"__esModule",{value:!0});var o=t("./animation/engine/Stage"),a=t("./audio/AudioHandler"),s=function(){function t(t){this.stage=new o.Stage(t),this.stage.start()}return t.prototype.play=function(e){return n(this,void 0,void 0,function(){return r(this,function(t){switch(t.label){case 0:return void 0!==a.default.song&&(a.default.song.pause(),a.default.song.currentTime=0),a.default.init(e),[4,a.default.play()];case 1:return t.sent(),[2]}})})},t}();i.PowerAudio=s},{"./animation/engine/Stage":10,"./audio/AudioHandler":11}],2:[function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0});var o=t("../../audio/AudioHandler"),a=function(i){function t(t){var e=i.call(this,t)||this;return e.setFriction(1),e}return r(t,i),t.prototype.redraw=function(){if(void 0!==this.graphics){var t=17*(Math.min(50,256*o.default.firstOrderAverage)/50)|0,e=parseInt("0x"+(t<<16|t<<8|t).toString(16),16);this.graphics.clear(),this.graphics.beginFill(e),this.graphics.drawRect(0,0,this.stage.getWidth(),this.stage.getHeight()),this.graphics.endFill()}},t}(t("../engine/DisplayObject").DisplayObject);i.AnimatedBackground=a},{"../../audio/AudioHandler":11,"../engine/DisplayObject":7}],3:[function(t,e,i){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0});var d=t("../../audio/AudioHandler"),r=function(r){function t(t,e,i){var n=r.call(this,t)||this;return n.centerX=e,n.centerY=i,n.lineWidth=1,n.eyesClosed=!1,n.targetPosition=new PIXI.Point(0,0),n.lastUpdatePosition=0,n.baseRadius=Math.min(t.getWidth(),t.getHeight())/12,n.radius=n.baseRadius,n.filter=new PIXI.filters.BlurFilter,n.filters=[n.filter],n.setFriction(1),n.position.x=e,n.position.y=i,n}return o(t,r),t.prototype.update=function(t){r.prototype.update.call(this,t),this.eyesClosed=Math.floor(10*Date.now()/1e3)%30==0,this.lineWidth=1+8*d.default.linearAverage,this.filter.blur=.2+8*Math.exp(-16*d.default.linearAverage),this.radius=this.baseRadius+100*d.default.linearAverage,this.setForce("main",{x:this.targetPosition.x-this.position.x,y:this.targetPosition.y-this.position.y}),Date.now()>400+this.lastUpdatePosition&&(this.updatePosition(),this.lastUpdatePosition=Date.now()),this.redraw()},t.prototype.updatePosition=function(){var t=2*Math.random()*Math.PI,e=.5*this.baseRadius,i=Math.cos(t)*e,n=Math.sin(t)*e;this.targetPosition.x=this.centerX+i,this.targetPosition.y=this.centerY+n},t.prototype.redraw=function(){if(void 0!==this.graphics){this.graphics.clear();for(var t=d.default.firstOrderWaveform,e=t.reduce(function(t,e){return t+e},0)/t.length,i=[],n=0,r=Math.PI/2;n<t.length;++n,r+=Math.PI/t.length){var o=Math.max(0,t[n]-e),a=Math.cos(r)*(this.radius+100*o),s=Math.sin(r)*(this.radius+100*o);i.push({x:a,y:s})}for(n=i.length-1;0<=n;--n)i.push({x:-i[n].x,y:i[n].y});this.graphics.beginFill(16777215,.2),this.graphics.lineStyle(this.lineWidth,16777215),this.graphics.moveTo(i[0].x,i[0].y);for(var c=0,h=i;c<h.length;c++){var u=h[c];this.graphics.lineTo(u.x,u.y)}this.graphics.beginFill(1118481,1),this.graphics.lineStyle(this.lineWidth,16777215),this.graphics.drawCircle(0,0,this.radius),this.graphics.endFill(),this.graphics.lineStyle(this.lineWidth,16777215),this.graphics.drawCircle(0,0,this.radius);var l=this.eyesClosed?.02*this.radius:.1*this.radius,p=.3*-this.radius;this.graphics.lineStyle(1,16777215),this.graphics.beginFill(16777215,1),this.graphics.drawRect(.5*-l,p-.5*l,l,l),this.graphics.drawRect(.3*this.radius-.5*l,p-.5*l,l,l)}},t}(t("../engine/DisplayObject").DisplayObject);i.AverageCircle=r},{"../../audio/AudioHandler":11,"../engine/DisplayObject":7}],4:[function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0});var o=t("../../audio/AudioHandler"),a=function(i){function t(t){var e=i.call(this,t)||this;return e.radius=2+4*Math.random(),e.color=16777215*(.5*Math.random()+.5),e.setFriction(1),e}return r(t,i),t.prototype.redraw=function(){if(void 0!==this.graphics){var t=255*(.5+Math.min(8,64*o.default.average)/16)|0,e=parseInt("0x"+(t<<16|t<<8|t).toString(16),16);this.graphics.clear(),this.graphics.beginFill(.15<o.default.average?this.color:e),this.graphics.drawCircle(0,0,this.radius),this.graphics.endFill()}},t.prototype.update=function(t){i.prototype.update.call(this,t);var e=Math.max(.1,8*o.default.average);this.position.x+=t*this.velocity.x*(e-1),this.position.y+=t*this.velocity.y*(e-1),this.x<0?this.x=this.stage.getWidth():this.x>this.stage.getWidth()&&(this.x=0),this.y<0?this.y=this.stage.getHeight():this.y>this.stage.getHeight()&&(this.y=0),this.redraw()},t}(t("../engine/DisplayObject").DisplayObject);i.Node=a},{"../../audio/AudioHandler":11,"../engine/DisplayObject":7}],5:[function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0});var o=t("../engine/DisplayObjectContainer"),a=t("./Node"),s=t("./NodeLinker"),c=function(i){function t(t){var e=i.call(this,t)||this;return e.nodes=new o.DisplayObjectContainer(e.stage),e.addChild(e.nodes),e.addChildAt(new s.NodeLinker(e.stage,e.nodes),0),e}return r(t,i),t.prototype.populate=function(){for(var t=10;t<this.stage.getWidth();t+=200)for(var e=10;e<this.stage.getHeight();e+=200)this.addNode(t+12*Math.random(),e+12*Math.random(),0,0)},t.prototype.addNode=function(t,e,i,n){var r=new a.Node(this.stage);r.position.set(t,e),r.velocity.set(i,n),this.nodes.addChild(r)},t}(o.DisplayObjectContainer);i.NodeContainer=c},{"../engine/DisplayObjectContainer":8,"./Node":4,"./NodeLinker":6}],6:[function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0});var o=t("../engine/DisplayObject"),y=t("../engine/Point"),a=function(f){function t(t,e){var i=f.call(this,t)||this;return i.target=e,i.centerPosition=new PIXI.Point(i.stage.getWidth()/2,6*i.stage.getHeight()/10),i}return r(t,f),t.prototype.redraw=function(){if(void 0!==this.graphics){this.graphics.clear(),this.graphics.lineStyle(1,16777215,.2);for(var t=this.target.children.length,e=0;e<t;++e){var i=this.target.children[e];y.Point.distance(i.position,this.centerPosition)>this.stage.getWidth()/10||(this.graphics.moveTo(i.position.x,i.position.y),this.graphics.lineTo(this.centerPosition.x,this.centerPosition.y))}}},t.prototype.update=function(t){f.prototype.update.call(this,t);for(var e=this.target.children.length,i=0;i<e;i++){var n=this.target.children[i],r=Math.atan2(n.position.y-this.centerPosition.y,n.position.x-this.centerPosition.x),o=y.Point.distance(n.position,this.centerPosition),a=1e5*-Math.cos(r)/o,s=1e5*-Math.sin(r)/o;n.setForce("tocenter",{x:a,y:s});for(var c=i+1;c<e;c++){var h=this.target.children[c],u=y.Point.distance(n.position,h.position);if(300<u)n.clearForce("node_"+h.id),h.clearForce("node_"+n.id);else{var l=Math.atan2(n.position.y-h.position.y,n.position.x-h.position.x),p=0,d=0;0!==u&&(p=1e4*Math.cos(l)/u,d=1e4*Math.sin(l)/u),n.setForce("node_"+h.id,new PIXI.Point(-p,-d)),h.setForce("node_"+n.id,new PIXI.Point(p,d))}}}this.redraw()},t}(o.DisplayObject);i.NodeLinker=a},{"../engine/DisplayObject":7,"../engine/Point":9}],7:[function(t,e,i){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0});var a=PIXI.Graphics,r=function(n){function r(t,e){var i=n.call(this)||this;return e=void 0===e||e,i.id=r.ID++,i.stage=t,i.graphics=void 0,i.velocity=new PIXI.Point(0,0),i.acceleration=new PIXI.Point(0,0),i.friction=new PIXI.Point(0,0),i.forces={},i.mass=1,e&&(i.graphics=new a,i.addChild(i.graphics)),i}return o(r,n),r.prototype.setForce=function(t,e){this.forces[t]={x:e.x,y:e.y}},r.prototype.clearForce=function(t){delete this.forces[t]},r.prototype.setFriction=function(t){"number"==typeof t?this.friction=new PIXI.Point(t,t):this.friction.set(t.x,t.y)},r.prototype.update=function(t){for(var e in this.setForce("friction",new PIXI.Point(-this.friction.x*this.velocity.x,-this.friction.y*this.velocity.y)),this.acceleration.set(0,0),this.forces)this.forces.hasOwnProperty(e)&&(this.acceleration.x+=this.forces[e].x,this.acceleration.y+=this.forces[e].y);this.acceleration.x/=this.mass,this.acceleration.y/=this.mass,this.velocity.x+=t*this.acceleration.x,this.velocity.y+=t*this.acceleration.y,this.position.x+=t*this.velocity.x,this.position.y+=t*this.velocity.y},r.ID=1,r}(PIXI.Container);i.DisplayObject=r},{}],8:[function(t,e,i){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0});var r=function(r){function t(t){return r.call(this,t,!1)||this}return o(t,r),t.prototype.update=function(t){r.prototype.update.call(this,t);for(var e=0,i=this.children.length;e<i;++e){var n=this.children[e];n.update&&n.update(t)}},t}(t("./DisplayObject").DisplayObject);i.DisplayObjectContainer=r},{"./DisplayObject":7}],9:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function t(){}return t.distance=function(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))},t}();i.Point=n},{}],10:[function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0});var o=t("../audio/AnimatedBackground"),a=t("../audio/AverageCircle"),s=t("../audio/NodeContainer"),c=function(i){function t(t){var e=i.call(this,null)||this;return e.canvasContainerID=t,e.canvasContainer=document.getElementById(t),e.lastDelta=0,e.renderer=PIXI.autoDetectRenderer(window.innerWidth,window.innerHeight),e.canvasContainer.appendChild(e.renderer.view),e.renderer.render(e),e.mouse={position:new PIXI.Point(0,0)},e.on("mousemove",function(t){e.mouse.position.set(t.data.global.x,t.data.global.y)}),e.lastUpdateDelta=0,e}return r(t,i),t.prototype.start=function(){for(;0<this.children.length;)this.removeChildAt(0);var t=new s.NodeContainer(this);t.populate(),this.addChild(t);var e=new a.AverageCircle(this,this.getWidth()/2,6*this.getHeight()/10);this.addChild(e),this.addChildAt(new o.AnimatedBackground(this),0),this.run()},t.prototype.getWidth=function(){return this.canvasContainer.clientWidth},t.prototype.getHeight=function(){return this.canvasContainer.clientHeight},t.prototype.update=function(){var t=Date.now()/1e3;this.lastDelta=t-this.lastUpdateDelta,this.lastUpdateDelta=t,1<this.lastDelta&&(this.lastDelta=0),i.prototype.update.call(this,this.lastDelta),this.renderer.render(this),requestAnimationFrame(this.update.bind(this))},t.prototype.run=function(){this.lastUpdateDelta=Date.now()/1e3,requestAnimationFrame(this.update.bind(this))},t}(t("./DisplayObjectContainer").DisplayObjectContainer);i.Stage=c},{"../audio/AnimatedBackground":2,"../audio/AverageCircle":3,"../audio/NodeContainer":5,"./DisplayObjectContainer":8}],11:[function(t,e,i){"use strict";var n=this&&this.__awaiter||function(o,a,s,c){return new(s||(s=Promise))(function(t,e){function i(t){try{r(c.next(t))}catch(t){e(t)}}function n(t){try{r(c.throw(t))}catch(t){e(t)}}function r(e){e.done?t(e.value):new s(function(t){t(e.value)}).then(i,n)}r((c=c.apply(o,a||[])).next())})},r=this&&this.__generator||function(i,n){var r,o,a,t,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,o&&(a=2&e[0]?o.return:e[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,e[1])).done)return a;switch(o=0,a&&(e=[2&e[0],a.value]),e[0]){case 0:case 1:a=e;break;case 4:return s.label++,{value:e[1],done:!1};case 5:s.label++,o=e[1],e=[0];continue;case 7:e=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===e[0]||2===e[0])){s=0;continue}if(3===e[0]&&(!a||e[1]>a[0]&&e[1]<a[3])){s.label=e[1];break}if(6===e[0]&&s.label<a[1]){s.label=a[1],a=e;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(e);break}a[2]&&s.ops.pop(),s.trys.pop();continue}e=n.call(i,s)}catch(t){e=[6,t],o=0}finally{r=a=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}};Object.defineProperty(i,"__esModule",{value:!0});var o=function(){function i(){}return i.init=function(t){var e=this;this.context=new(AudioContext||window.webkitAudioContext),this.gain=i.context.createGain(),this.gain.connect(this.context.destination),this.song=new Audio(t),this.song.crossOrigin="anonymous",this.isPlaying=!1,this.context.createMediaElementSource(this.song).connect(this.gain),this.analyser=this.context.createAnalyser(),this.gain.connect(this.analyser),this.analyser.fftSize=i.FFT_SIZE,this.waveform=new Float32Array(this.analyser.frequencyBinCount),this.firstOrderWaveform=new Float32Array(this.analyser.frequencyBinCount),this.analyser.getFloatTimeDomainData(this.waveform),this.lastUpdateDelta=Date.now(),this.updateStatsInterval=setInterval(function(){return e.updateStats()},i.STATS_UPDATE_INTERVAL)},i.updateStats=function(){var i=this,n=(Date.now()-this.lastUpdateDelta)/1e3;this.analyser.getFloatTimeDomainData(this.waveform),this.average=this.waveform.reduce(function(t,e){return t+Math.abs(e)},0)/this.analyser.frequencyBinCount,this.minimum=this.waveform.reduce(function(t,e){return Math.min(t,e)},this.waveform[0]),this.maximum=this.waveform.reduce(function(t,e){return Math.max(t,e)},this.waveform[0]),this.firstOrderAverage+=.5*(this.average-this.firstOrderAverage)*n,this.linearAverage+=n*(this.average>this.linearAverage?1:-1),this.waveform.forEach(function(t,e){t>i.firstOrderWaveform[e]?i.firstOrderWaveform[e]=t:i.firstOrderWaveform[e]+=1.1*(t-i.firstOrderWaveform[e])*n}),this.lastUpdateDelta=Date.now()},i.play=function(){return n(this,void 0,void 0,function(){return r(this,function(t){switch(t.label){case 0:return[4,this.song.play()];case 1:return t.sent(),this.isPlaying=!0,this.updateStats(),[2]}})})},i.FFT_SIZE=256,i.STATS_UPDATE_INTERVAL=25,i.average=0,i.firstOrderAverage=0,i.linearAverage=0,i.minimum=0,i.maximum=0,i.lastUpdateDelta=0,i}();i.default=o},{}],12:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=t("./PowerAudio");e.exports=n.PowerAudio},{"./PowerAudio":1}]},{},[12])(12)});
//# sourceMappingURL=power-audio.js.map
